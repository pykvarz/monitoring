# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –∏ —É–ª—É—á—à–µ–Ω–∏—è - Network Monitor

**–î–∞—Ç–∞**: 2026-01-12  
**–í–µ—Ä—Å–∏—è**: 2.1  
**–°—Ç–∞—Ç—É—Å**: üìã –°–ø–∏—Å–æ–∫ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è

---

## üîç –ù–∞–π–¥–µ–Ω–Ω—ã–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º –±—ã–ª –ø—Ä–æ–≤–µ–¥–µ–Ω –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã. –í–æ—Ç —á—Ç–æ –±—ã–ª–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ:

---

## 1. üö® –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ print() –≤–º–µ—Å—Ç–æ logging

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üî¥ **–í–´–°–û–ö–ò–ô**  
**–§–∞–π–ª—ã**: `storage.py`, `services.py`, `host_manager.py`

### –ü—Ä–æ–±–ª–µ–º–∞:
–í 14 –º–µ—Å—Ç–∞—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `print()` –≤–º–µ—Å—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è.

### –ù–∞–π–¥–µ–Ω–Ω—ã–µ —Å–ª—É—á–∞–∏:

#### storage.py (8 —Å–ª—É—á–∞–µ–≤):
```python
# –°—Ç—Ä–æ–∫–∞ 49
print(f"–ü—Ä–æ–ø—É—Å–∫ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —É–∑–ª–∞: {host_data.get('ip', 'unknown')}: {e}")

# –°—Ç—Ä–æ–∫–∞ 58
print(f"–£–∑–µ–ª {host.ip} –Ω–µ –ø—Ä–æ—à–µ–ª –≤–∞–ª–∏–¥–∞—Ü–∏—é, –±—É–¥–µ—Ç –ø—Ä–æ–ø—É—â–µ–Ω")

# –°—Ç—Ä–æ–∫–∞ 61
print(f"–ó–∞–≥—Ä—É–∂–µ–Ω–æ {len(valid_hosts)} –∏–∑ {len(hosts)} —É–∑–ª–æ–≤, {len(hosts) - len(valid_hosts)} –ø—Ä–æ–ø—É—â–µ–Ω–æ")

# –°—Ç—Ä–æ–∫–∞ 66
print(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —É–∑–ª–æ–≤: {e}")

# –°—Ç—Ä–æ–∫–∞ 77
print(f"–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —É–∑–ª–æ–≤: {e}")

# –ò –µ—â–µ 3...
```

#### services.py (4 —Å–ª—É—á–∞—è):
```python
# –°—Ç—Ä–æ–∫–∞ 43
print(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π: {e}")
```

#### host_manager.py (2 —Å–ª—É—á–∞—è):
```python
# –°—Ç—Ä–æ–∫–∞ 79
print(f"Crash prevention in delete_selected: {e}")
```

### –ü–æ—á–µ–º—É —ç—Ç–æ –ø–ª–æ—Ö–æ:
- ‚ùå `print()` –≤—ã–≤–æ–¥–∏—Ç –≤ –∫–æ–Ω—Å–æ–ª—å, –∞ –Ω–µ –≤ –ª–æ–≥-—Ñ–∞–π–ª
- ‚ùå –ù–µ–ª—å–∑—è –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚ùå –°–ª–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
- ‚ùå –ù–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫
- ‚ùå –ù–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `debug.log`

### –†–µ—à–µ–Ω–∏–µ:
–ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ `print()` –Ω–∞ `logging.warning()` –∏–ª–∏ `logging.error()`:

```python
# –ë—ã–ª–æ:
print(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —É–∑–ª–æ–≤: {e}")

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
logging.error(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —É–∑–ª–æ–≤: {e}", exc_info=True)
```

---

## 2. ‚ö†Ô∏è –•–∞—Ä–¥–∫–æ–¥ –ø—É—Ç–µ–π –∫ —Ñ–∞–π–ª–∞–º

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° **–°–†–ï–î–ù–ò–ô**  
**–§–∞–π–ª**: `storage.py`

### –ü—Ä–æ–±–ª–µ–º–∞:

```python
class StorageManager:
    def __init__(self):
        self._hosts_file = Path("hosts.json")      # –•–∞—Ä–¥–∫–æ–¥!
        self._config_file = Path("config.json")    # –•–∞—Ä–¥–∫–æ–¥!
```

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:
- ‚ùå –§–∞–π–ª—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ (–º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±–æ–π)
- ‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø—É—Ç—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞
- ‚ùå –°–ª–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å (—Ç–µ—Å—Ç—ã —Å–æ–∑–¥–∞—é—Ç —Ñ–∞–π–ª—ã –≤ —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏)
- ‚ùå –ù–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –†–µ—à–µ–Ω–∏–µ:

```python
from pathlib import Path
import os

class StorageManager:
    def __init__(self, data_dir: Optional[Path] = None):
        # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–∞—Ç–∞–ª–æ–≥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        if data_dir is None:
            if os.name == 'nt':  # Windows
                data_dir = Path(os.getenv('APPDATA')) / 'NetworkMonitor'
            else:  # Linux/Mac
                data_dir = Path.home() / '.network_monitor'
        
        data_dir.mkdir(parents=True, exist_ok=True)
        self._hosts_file = data_dir / "hosts.json"
        self._config_file = data_dir / "config.json"
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- ‚úÖ –§–∞–π–ª—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Å–∏—Å—Ç–µ–º–Ω–æ–º –∫–∞—Ç–∞–ª–æ–≥–µ
- ‚úÖ –õ–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å (–ø–µ—Ä–µ–¥–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π
- ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –û–°

---

## 3. üîí –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø—É—Ç–µ–π —Ñ–∞–π–ª–æ–≤

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° **–°–†–ï–î–ù–ò–ô**  
**–§–∞–π–ª—ã**: `export_import_manager.py`, `excel_service.py`

### –ü—Ä–æ–±–ª–µ–º–∞:
–ü—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ/—ç–∫—Å–ø–æ—Ä—Ç–µ –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞:
- Path traversal –∞—Ç–∞–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `../../etc/passwd`)
- –ó–∞–ø–∏—Å—å –≤ –∑–∞—â–∏—â–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- –ü–µ—Ä–µ–∑–∞–ø–∏—Å—å –≤–∞–∂–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

### –†–∏—Å–∫–∏:
```python
# –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —É–∫–∞–∑–∞—Ç—å –ª—é–±–æ–π –ø—É—Ç—å:
file_path = "C:\\Windows\\System32\\important.xlsx"  # –û–ø–∞—Å–Ω–æ!
```

### –†–µ—à–µ–Ω–∏–µ:

```python
def _validate_file_path(self, file_path: str) -> bool:
    """–í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª—É"""
    try:
        path = Path(file_path).resolve()
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
        forbidden_dirs = [
            Path("C:\\Windows").resolve(),
            Path("C:\\Program Files").resolve(),
            Path("/etc"),
            Path("/sys"),
        ]
        
        for forbidden in forbidden_dirs:
            try:
                path.relative_to(forbidden)
                logging.error(f"–ü–æ–ø—ã—Ç–∫–∞ –∑–∞–ø–∏—Å–∏ –≤ –∑–∞—â–∏—â–µ–Ω–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é: {path}")
                return False
            except ValueError:
                pass  # –ù–µ —è–≤–ª—è–µ—Ç—Å—è –ø–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–µ–π
        
        return True
    except Exception as e:
        logging.error(f"–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø—É—Ç–∏: {e}")
        return False
```

---

## 4. üéØ –ú–∞–≥–∏—á–µ—Å–∫–∏–µ —á–∏—Å–ª–∞ –∏ —Å—Ç—Ä–æ–∫–∏

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü¢ **–ù–ò–ó–ö–ò–ô**  
**–§–∞–π–ª—ã**: –ú–Ω–æ–∂–µ—Å—Ç–≤–æ

### –ü—Ä–æ–±–ª–µ–º—ã:

```python
# filter_manager.py, —Å—Ç—Ä–æ–∫–∞ 35
self._filter_timer.setInterval(300)  # –ß—Ç–æ —Ç–∞–∫–æ–µ 300?

# dashboard_manager.py, —Å—Ç—Ä–æ–∫–∞ 39
self._update_timer.setInterval(500)  # –ß—Ç–æ —Ç–∞–∫–æ–µ 500?

# monitor_thread.py, —Å—Ç—Ä–æ–∫–∞ 92
result = PingService.ping_host(host.ip, timeout=2.0)  # –ü–æ—á–µ–º—É 2.0?

# main_window.py, —Å—Ç—Ä–æ–∫–∞ 94
self._save_timer.setInterval(30000)  # 30000 —ç—Ç–æ —Å–∫–æ–ª—å–∫–æ?
```

### –†–µ—à–µ–Ω–∏–µ:
–í—ã–Ω–µ—Å—Ç–∏ –≤ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã:

```python
# constants.py
# –¢–∞–π–º–∏–Ω–≥–∏ (–≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö)
FILTER_DEBOUNCE_MS = 300
DASHBOARD_UPDATE_DEBOUNCE_MS = 500
AUTOSAVE_INTERVAL_MS = 30000

# –¢–∞–π–º–∏–Ω–≥–∏ —Å–µ—Ç–∏ (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö)
PING_TIMEOUT_SECONDS = 2.0

# UI
MIN_COLUMN_WIDTH = 110
MAX_COLUMN_WIDTH = 50
```

---

## 5. üì¶ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° **–°–†–ï–î–ù–ò–ô**

### –ü—Ä–æ–±–ª–µ–º–∞:
–ù–µ—Ç —Ñ–∞–π–ª–∞ `requirements.txt` –∏–ª–∏ `pyproject.toml` —Å–æ —Å–ø–∏—Å–∫–æ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

### –¢–µ–∫—É—â–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```
PyQt5
openpyxl
```

### –†–µ—à–µ–Ω–∏–µ:
–°–æ–∑–¥–∞—Ç—å `requirements.txt`:

```txt
PyQt5>=5.15.0,<6.0.0
openpyxl>=3.0.0,<4.0.0
```

–ò/–∏–ª–∏ `pyproject.toml`:

```toml
[project]
name = "network-monitor"
version = "2.1.0"
requires-python = ">=3.7"
dependencies = [
    "PyQt5>=5.15.0,<6.0.0",
    "openpyxl>=3.0.0,<4.0.0",
]
```

---

## 6. üß™ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–µ—Å—Ç–æ–≤

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° **–°–†–ï–î–ù–ò–ô**

### –ü—Ä–æ–±–ª–µ–º–∞:
–ù–µ—Ç –Ω–∏ –æ–¥–Ω–æ–≥–æ unit-—Ç–µ—Å—Ç–∞.

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç—ã —Ö–æ—Ç—è –±—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

```python
# tests/test_models.py
import pytest
from models import Host, validate_ip_or_hostname

def test_host_creation_valid():
    host = Host(name="Server1", ip="192.168.1.1")
    assert host.name == "Server1"
    assert host.ip == "192.168.1.1"

def test_host_creation_invalid_ip():
    with pytest.raises(ValueError):
        Host(name="Server1", ip="999.999.999.999")

def test_validate_ip_valid():
    assert validate_ip_or_hostname("192.168.1.1") == True
    assert validate_ip_or_hostname("google.com") == True

def test_validate_ip_invalid():
    assert validate_ip_or_hostname("999.999.999.999") == False
    assert validate_ip_or_hostname("") == False
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤**:
```
tests/
‚îú‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ test_models.py
‚îú‚îÄ‚îÄ test_storage.py
‚îú‚îÄ‚îÄ test_filter_manager.py
‚îú‚îÄ‚îÄ test_dashboard_manager.py
‚îî‚îÄ‚îÄ test_excel_service.py
```

---

## 7. üîß –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –≤ –º–µ–Ω–µ–¥–∂–µ—Ä–∞—Ö

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü¢ **–ù–ò–ó–ö–ò–ô**  
**–§–∞–π–ª—ã**: `theme_manager.py`, `dialogs.py`, `dashboard_manager.py`

### –ü—Ä–æ–±–ª–µ–º–∞:
–ú–µ—Ç–æ–¥ `_get_b64_svg()` –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è –∏ –º–µ—Ç–æ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–∫–æ–Ω–∫–∏ –æ–∫–Ω–∞ –∏–∑ SVG —Ç–æ–∂–µ.

#### dashboard_manager.py:
```python
@staticmethod
def _get_b64_svg(svg_data: str) -> str:
    return base64.b64encode(svg_data.encode('utf-8')).decode('utf-8')
```

#### dialogs.py (HostDialog):
```python
def _set_window_icon(self):
    svg_data = get_svg_add_host("light")
    renderer = QSvgRenderer(QByteArray(svg_data.encode('utf-8')))
    # ...
```

#### dialogs.py (SettingsDialog):
```python
def _set_window_icon(self):
    svg_data = get_svg_settings("light")
    renderer = QSvgRenderer(QByteArray(svg_data.encode('utf-8')))
    # ...
```

### –†–µ—à–µ–Ω–∏–µ:
–°–æ–∑–¥–∞—Ç—å `utils.py` —Å –æ–±—â–∏–º–∏ —É—Ç–∏–ª–∏—Ç–∞–º–∏:

```python
# utils.py
import base64
from PyQt5.QtGui import QIcon, QPixmap, QPainter
from PyQt5.QtSvg import QSvgRenderer
from PyQt5.QtCore import Qt, QByteArray

def svg_to_base64(svg_data: str) -> str:
    """–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è SVG –≤ base64"""
    return base64.b64encode(svg_data.encode('utf-8')).decode('utf-8')

def svg_to_qicon(svg_data: str, size: int = 32) -> QIcon:
    """–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è SVG –≤ QIcon"""
    renderer = QSvgRenderer(QByteArray(svg_data.encode('utf-8')))
    pixmap = QPixmap(size, size)
    pixmap.fill(Qt.transparent)
    painter = QPainter(pixmap)
    renderer.render(painter)
    painter.end()
    return QIcon(pixmap)
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
```python
from utils import svg_to_qicon, svg_to_base64

# –í DialogHostDialog
self.setWindowIcon(svg_to_qicon(get_svg_add_host("light")))

# –í DashboardManager
b64 = svg_to_base64(svg_total)
```

---

## 8. üìù –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü¢ **–ù–ò–ó–ö–ò–ô**

### –ü—Ä–æ–±–ª–µ–º—ã:
1. –ù–µ—Ç `README.md` —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ
2. –ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞
3. –ù–µ –≤—Å–µ –ø—É–±–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏–º–µ—é—Ç docstrings
4. –ù–µ—Ç –ø—Ä–∏–º–µ—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

#### README.md
```markdown
# Network Monitor

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–µ—Ç–µ–≤—ã—Ö —É–∑–ª–æ–≤ —Å –∫—Ä–∞—Å–∏–≤—ã–º UI.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
pip install -r requirements.txt
```

## –ó–∞–ø—É—Å–∫

```bash
python main.py
```

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîç –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —É–∑–ª–æ–≤
- üìä –î–∞—à–±–æ—Ä–¥ —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
- üåì –¢–µ–º–Ω–∞—è –∏ —Å–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞
- üì• –ò–º–ø–æ—Ä—Ç/—ç–∫—Å–ø–æ—Ä—Ç Excel
- üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–±–æ—è—Ö
```

#### ARCHITECTURE.md
```markdown
# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –ú–æ–¥–µ–ª–∏ (`models.py`)
- `Host` - –º–æ–¥–µ–ª—å —Ö–æ—Å—Ç–∞
- `AppConfig` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- `HostStatus` - —Å—Ç–∞—Ç—É—Å—ã

### –ú–µ–Ω–µ–¥–∂–µ—Ä—ã
- `FilterManager` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- `ThemeManager` - —Ç–µ–º—ã
- `DashboardManager` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `ExportImportManager` - –∏–º–ø–æ—Ä—Ç/—ç–∫—Å–ø–æ—Ä—Ç
```

---

## 9. üîê –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üî¥ **–í–´–°–û–ö–ò–ô** (–¥–ª—è production)

### 9.1 –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø—Ä–∏ deserialization

**–§–∞–π–ª**: `storage.py`

```python
# –°—Ç—Ä–æ–∫–∞ 46
host = Host(**host_data)  # –û–ø–∞—Å–Ω–æ! –ú–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ª–∏—à–Ω–∏–µ –ø–æ–ª—è
```

**–†–∏—Å–∫**: –ï—Å–ª–∏ JSON —Ñ–∞–π–ª –±—ã–ª –∏–∑–º–µ–Ω–µ–Ω –≤—Ä—É—á–Ω—É—é, –º–æ–∂–µ—Ç –ø—Ä–æ–∏–∑–æ–π—Ç–∏:
- Injection –∞—Ç–∞–∫–∞ —á–µ—Ä–µ–∑ –ø–æ–ª—è
- DoS —á–µ—Ä–µ–∑ –æ–≥—Ä–æ–º–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞

**–†–µ—à–µ–Ω–∏–µ**:
```python
# –ë–µ–ª—ã–π —Å–ø–∏—Å–æ–∫ –ø–æ–ª–µ–π
ALLOWED_HOST_FIELDS = {'name', 'ip', 'address', 'group', 'status', 
                       'last_seen', 'offline_since', 'notified', 
                       'notifications_enabled', 'id'}

try:
    # –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –ø–æ–ª—è
    safe_data = {k: v for k, v in host_data.items() 
                 if k in ALLOWED_HOST_FIELDS}
    host = Host(**safe_data)
except (TypeError, ValueError) as e:
    # ...
```

### 9.2 –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤

**–§–∞–π–ª**: `excel_service.py`

```python
# –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–º–µ—Ä–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ
workbook = openpyxl.load_workbook(file_path, read_only=True)
```

**–†–∏—Å–∫**: DoS –∞—Ç–∞–∫–∞ —á–µ—Ä–µ–∑ –æ–≥—Ä–æ–º–Ω—ã–π —Ñ–∞–π–ª (1GB+)

**–†–µ—à–µ–Ω–∏–µ**:
```python
MAX_FILE_SIZE = 10 * 1024 * 1024  # 10MB

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –ø–µ—Ä–µ–¥ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º
file_size = Path(file_path).stat().st_size
if file_size > MAX_FILE_SIZE:
    raise ValueError(f"–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π: {file_size / 1024 / 1024:.1f}MB (–º–∞–∫—Å. 10MB)")
```

---

## 10. ‚ö° –ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° **–°–†–ï–î–ù–ò–ô**

### 10.1 –ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã

**–§–∞–π–ª**: `main_window.py`

```python
def _refresh_table(self):
    # –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –í–°–ï–• –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ñ–∞–π–ª–∞ –∫–∞–∂–¥—ã–π —Ä–∞–∑!
    with QMutexLocker(self._hosts_mutex):
        self._hosts = self._storage.load_hosts()  # –ú–µ–¥–ª–µ–Ω–Ω–æ!
```

**–ü—Ä–æ–±–ª–µ–º–∞**: –ü—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–µ—Ä–µ—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤–µ—Å—å —Ñ–∞–π–ª.

**–†–µ—à–µ–Ω–∏–µ**: –û–±–Ω–æ–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
```python
def _refresh_table(self, reload_from_disk: bool = False):
    if reload_from_disk:
        with QMutexLocker(self._hosts_mutex):
            self._hosts = self._storage.load_hosts()
    # –ò–Ω–∞—á–µ –ø—Ä–æ—Å—Ç–æ –æ–±–Ω–æ–≤–ª—è–µ–º UI
    self._load_table()
```

### 10.2 –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ UI –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏

**–§–∞–π–ª**: `storage.py`

```python
def save_hosts(self, hosts: List[Host]) -> bool:
    with self._lock():  # –ë–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ—Ç–æ–∫ UI!
        with open(self._hosts_file, 'w', encoding='utf-8') as f:
            json.dump(...)  # –ú–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–º –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
```

**–†–µ—à–µ–Ω–∏–µ**: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ:
```python
from threading import Thread

def save_hosts_async(self, hosts: List[Host], callback=None):
    """–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ"""
    def _save():
        result = self.save_hosts(hosts)
        if callback:
            callback(result)
    
    Thread(target=_save).start()
```

---

## üìä –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤

| ‚Ññ | –ü—Ä–æ–±–ª–µ–º–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –°–ª–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –†–∏—Å–∫ |
|---|----------|-----------|----------------------|------|
| 1 | print() –≤–º–µ—Å—Ç–æ logging | üî¥ –í—ã—Å–æ–∫–∏–π | –ù–∏–∑–∫–∞—è | –ù–∏–∑–∫–∏–π |
| 2 | –•–∞—Ä–¥–∫–æ–¥ –ø—É—Ç–µ–π –∫ —Ñ–∞–π–ª–∞–º | üü° –°—Ä–µ–¥–Ω–∏–π | –°—Ä–µ–¥–Ω—è—è | –°—Ä–µ–¥–Ω–∏–π |
| 3 | –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø—É—Ç–µ–π | üü° –°—Ä–µ–¥–Ω–∏–π | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–∏–π |
| 4 | –ú–∞–≥–∏—á–µ—Å–∫–∏–µ —á–∏—Å–ª–∞ | üü¢ –ù–∏–∑–∫–∏–π | –ù–∏–∑–∫–∞—è | –ù–∏–∑–∫–∏–π |
| 5 | –ù–µ—Ç requirements.txt | üü° –°—Ä–µ–¥–Ω–∏–π | –ù–∏–∑–∫–∞—è | –°—Ä–µ–¥–Ω–∏–π |
| 6 | –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–µ—Å—Ç–æ–≤ | üü° –°—Ä–µ–¥–Ω–∏–π | –í—ã—Å–æ–∫–∞—è | –°—Ä–µ–¥–Ω–∏–π |
| 7 | –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ | üü¢ –ù–∏–∑–∫–∏–π | –°—Ä–µ–¥–Ω—è—è | –ù–∏–∑–∫–∏–π |
| 8 | –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | üü¢ –ù–∏–∑–∫–∏–π | –°—Ä–µ–¥–Ω—è—è | –ù–∏–∑–∫–∏–π |
| 9 | –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ | üî¥ –í—ã—Å–æ–∫–∏–π | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–∏–π |
| 10 | –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | üü° –°—Ä–µ–¥–Ω–∏–π | –°—Ä–µ–¥–Ω—è—è | –°—Ä–µ–¥–Ω–∏–π |

---

## üéØ –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### –§–∞–∑–∞ 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (1-2 —á–∞—Å–∞)
1. ‚úÖ –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ `print()` –Ω–∞ `logging`
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø—É—Ç–µ–π —Ñ–∞–π–ª–æ–≤
3. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤
4. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø—Ä–∏ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏

### –§–∞–∑–∞ 2: –í–∞–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (2-3 —á–∞—Å–∞)
5. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ö–∞—Ä–¥–∫–æ–¥ –ø—É—Ç–µ–π –∫ —Ñ–∞–π–ª–∞–º
6. ‚úÖ –°–æ–∑–¥–∞—Ç—å `requirements.txt`
7. ‚úÖ –í—ã–Ω–µ—Å—Ç–∏ –º–∞–≥–∏—á–µ—Å–∫–∏–µ —á–∏—Å–ª–∞ –≤ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
8. ‚úÖ –°–æ–∑–¥–∞—Ç—å `utils.py` –∏ —É–±—Ä–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

### –§–∞–∑–∞ 3: –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞ (3-5 —á–∞—Å–æ–≤)
9. ‚úÖ –ù–∞–ø–∏—Å–∞—Ç—å –±–∞–∑–æ–≤—ã–µ unit-—Ç–µ—Å—Ç—ã
10. ‚úÖ –°–æ–∑–¥–∞—Ç—å README.md –∏ ARCHITECTURE.md
11. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å docstrings –∫–æ –≤—Å–µ–º –ø—É–±–ª–∏—á–Ω—ã–º –º–µ—Ç–æ–¥–∞–º
12. ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

---

## üí° –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –∫–∞—á–µ—Å—Ç–≤–∞:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∏–ª—è –∫–æ–¥–∞
pip install flake8 black mypy

# –ó–∞–ø—É—Å–∫
flake8 .
black --check .
mypy .
```

### CI/CD:
–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ GitHub Actions:
```yaml
name: Tests
on: [push]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-python@v2
      - run: pip install -r requirements.txt
      - run: pytest
      - run: flake8 .
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
–î–æ–±–∞–≤–∏—Ç—å —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—é –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ:
```python
import sentry_sdk

sentry_sdk.init(
    dsn="your-dsn-here",
    traces_sample_rate=1.0
)
```

---

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∞–≥–∏ –±—ã–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã, –æ—Å—Ç–∞–µ—Ç—Å—è –µ—â–µ –º–Ω–æ–≥–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è:

‚úÖ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –∏ –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫  
‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ó–∞—â–∏—Ç–∏—Ç—å –æ—Ç –±–∞–∑–æ–≤—ã—Ö –∞—Ç–∞–∫  
‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å —Ñ–∞–π–ª–∞–º–∏  
‚úÖ **–ö–∞—á–µ—Å—Ç–≤–æ**: –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é  
‚úÖ **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å**: –£–±—Ä–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–∞–≥–∏—á–µ—Å–∫–∏–µ —á–∏—Å–ª–∞  

–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ - –ø—Ä–∏—Å—Ç—É–ø–∏—Ç—å –∫ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é –ø—Ä–æ–±–ª–µ–º –∏–∑ **–§–∞–∑—ã 1** (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ). üöÄ
